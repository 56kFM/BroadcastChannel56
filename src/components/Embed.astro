---
import EmbedFrame from './EmbedFrame.astro'
import { detectEmbed } from '../lib/embeds'

const { url } = Astro.props as { url: string }

const spec = detectEmbed(url)
---

{
  spec ? (
    <div class="embed-container">
      <EmbedFrame spec={spec} originalUrl={url} />
      <p class="embed-fallback">
        <a href={url} rel="noopener nofollow ugc">
          {url}
        </a>
      </p>
    </div>
  ) : (
    <a href={url} rel="noopener nofollow ugc">
      {url}
    </a>
  )
}

<style>
  .embed-container {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }

  .embed-fallback {
    margin: 0;
    font-size: 0.85rem;
    line-height: 1.4;
    word-break: break-all;
  }

  .embed-fallback a {
    color: inherit;
    text-decoration: underline;
  }
</style>
