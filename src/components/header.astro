---
import { getEnv } from '../lib/env'
import voidFile from '../assets/void.png'
import { normalizeStaticProxy, toProxyUrl } from '../lib/static-proxy'

const { BASE_URL } = Astro.locals
const { channel } = Astro.props
const rawTitleSuffix = typeof Astro.props.titleSuffix === 'string' ? Astro.props.titleSuffix : ''
const titleSuffix = rawTitleSuffix.trim()

const staticProxy = normalizeStaticProxy(getEnv(import.meta.env, Astro, 'STATIC_PROXY'))
const avatarSrc = toProxyUrl(staticProxy, channel?.avatar) || voidFile.src
---

<div id="header-section">
  <div id="header">
    <a href={BASE_URL} title={channel?.title}>
      <img src={avatarSrc} alt={channel?.title} loading="eager" class="header-avatar" />
    </a>
    <div class="header-title">
      <a href={BASE_URL} class="site-title" title={channel?.title}>
        {channel?.title}
      </a>
      {titleSuffix.length > 0 && <span class="site-title-suffix">{titleSuffix}</span>}
    </div>
  </div>
</div>
