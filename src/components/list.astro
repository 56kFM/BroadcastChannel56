---
import Layout from '../layouts/base.astro'
import Header from '../components/header.astro'
import Item from '../components/item.astro'

const { channel, page = undefined, posts: explicitPosts, isItem = false, paginationGap = false } = Astro.props

const posts = Array.isArray(explicitPosts)
  ? explicitPosts
  : Array.isArray(page?.data)
    ? page.data
    : Array.isArray(channel?.posts)
      ? channel.posts
      : []

const paginationClassList = {
  'pages-container': true,
  'pages-container--with-gap': paginationGap,
}

const showPager = Boolean(page?.url?.prev || page?.url?.next)
---

<Layout channel={channel} id="main-container">
  <slot name="header">
    <Header channel={channel} />
  </slot>
  <div class="items">
    {
      posts.map((post, index) => (
        <Item post={post} isItem={isItem} key={post.id ?? `${post.datetime ?? 'post'}-${index}`} />
      ))
    }
  </div>

  {
    showPager && (
      <nav class:list={paginationClassList} aria-label="Pagination">
        {page?.url?.prev && (
          <a href={page.url.prev} rel="prev" aria-label="Newer posts" class="page">
            ← Newer
          </a>
        )}
        {page?.url?.next && (
          <a href={page.url.next} rel="next" aria-label="Older posts" class="page">
            Older →
          </a>
        )}
      </nav>
    )
  }
</Layout>
